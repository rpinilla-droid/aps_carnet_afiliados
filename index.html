<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<title>Carnet generado por código</title>
<script src="https://cdn.jsdelivr.net/npm/pdf-lib/dist/pdf-lib.min.js"></script>

<style>
body { font-family: Arial; padding: 40px; }
button { padding: 12px 25px; font-size: 16px; }
</style>
</head>

<body>

<h2>Generar carnet (sin plantilla PDF)</h2>
<p>Este carnet se genera 100% por código replicando tu diseño.</p>

<button onclick="generarCarnet()">Descargar Carnet</button>

<script>
async function generarCarnet() {

    // Estos datos vendrán desde tu CSV (esto es solo un ejemplo)
    const d = {
        nombre: "JUAN SEBASTIAN YNOA ACOSTA",
        cedula: "18026-47363-00",
        nss: "185586226",
        poliza: "402-3992803-5",
        fecha: "25/09/2005"
    };

    // Dimensiones del PDF según tu archivo real
    const WIDTH = 595;
    const HEIGHT = 420;

    const pdfDoc = await PDFLib.PDFDocument.create();
    const page = pdfDoc.addPage([WIDTH, HEIGHT]);

    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.Helvetica);
    const bold = await pdfDoc.embedFont(PDFLib.StandardFonts.HelveticaBold);

    // Fondo blanco
    page.drawRectangle({
        x: 0,
        y: 0,
        width: WIDTH,
        height: HEIGHT,
        color: PDFLib.rgb(1, 1, 1)
    });

    // Cuadro principal (gris claro)
    page.drawRectangle({
        x: 20,
        y: 20,
        width: WIDTH - 40,
        height: HEIGHT - 40,
        color: PDFLib.rgb(0.96, 0.96, 0.96),
        borderWidth: 2,
        borderColor: PDFLib.rgb(0, 0, 0)
    });

    // TÍTULO PRINCIPAL (simula encabezado del carnet)
    page.drawText("Cédula:", {
        x: 40, y: HEIGHT - 80,
        size: 14, font: bold
    });
    page.drawText(d.cedula, {
        x: 120, y: HEIGHT - 80,
        size: 14, font
    });

    // Nombre en grande (centrado como en el PDF)
    page.drawText(d.nombre, {
        x: 40,
        y: HEIGHT - 120,
        size: 18,
        font: bold
    });

    // Etiquetas alineadas igual que en el Test_Carnet.pdf
    page.drawText("Nombre", { x: 40, y: HEIGHT - 150, size: 12, font });
    page.drawText("Póliza", { x: 40, y: HEIGHT - 180, size: 12, font });
    page.drawText("Fecha Nac.", { x: 180, y: HEIGHT - 180, size: 12, font });
    page.drawText("NSS:", { x: 40, y: HEIGHT - 210, size: 12, font });

    // Valores (alineados con el PDF)
    page.drawText(d.poliza, { x: 40, y: HEIGHT - 195, size: 14, font });
    page.drawText(d.fecha, { x: 180, y: HEIGHT - 195, size: 14, font });
    page.drawText(d.nss, { x: 80, y: HEIGHT - 210, size: 14, font });

    // Pie de página (tal cual aparece en tu PDF)
    page.drawText("PRESENTAR JUNTO A ESTE CARNET SU DOCUMENTO DE IDENTIDAD", {
        x: 40,
        y: 40,
        size: 12,
        font: bold
    });

    // Descarga del PDF
    const pdfBytes = await pdfDoc.save();
    const blob = new Blob([pdfBytes], { type: "application/pdf" });
    const url = URL.createObjectURL(blob);

    const a = document.createElement("a");
    a.href = url;
    a.download = "Carnet_Asegurado.pdf";
    a.click();
    URL.revokeObjectURL(url);
}
</script>

</body>
</html>
