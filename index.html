<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>Generar Carnet PDF</title>
<script src="https://cdn.jsdelivr.net/npm/pdf-lib/dist/pdf-lib.min.js"></script>
</head>

<body>
<h2>Generar Carnet sin plantilla</h2>

<button onclick="generarPDF()">Descargar Carnet</button>

<script>
async function generarPDF() {

    // Simulación de datos obtenidos del CSV
    const d = {
        nombre: "JUAN SEBASTIAN YNOA ACOSTA",
        cedula: "18026-47363-00",
        nss: "185586226",
        poliza: "402-3992803-5",
        fecha: "25/09/2005"
    };

    // Crear PDF vacío
    const pdfDoc = await PDFLib.PDFDocument.create();
    const page = pdfDoc.addPage([350, 500]);

    const font = await pdfDoc.embedFont(PDFLib.StandardFonts.Helvetica);

    // Fondo gris claro
    page.drawRectangle({
        x: 10,
        y: 10,
        width: 330,
        height: 480,
        color: PDFLib.rgb(0.95, 0.95, 0.95),
        borderWidth: 1
    });

    // Título
    page.drawText("CARNET DE AFILIADO", {
        x: 90,
        y: 450,
        size: 16,
        font,
    });

    // Campos
    const campos = [
        { label: "Nombre:", value: d.nombre },
        { label: "Cédula:", value: d.cedula },
        { label: "NSS:", value: d.nss },
        { label: "Póliza:", value: d.poliza },
        { label: "Fecha Nac.:", value: d.fecha }
    ];

    let y = 400;

    campos.forEach(c => {
        page.drawText(c.label, { x: 20, y, size: 12, font });
        page.drawText(c.value, { x: 120, y, size: 12, font });
        y -= 40;
    });

    // Pie de página
    page.drawText("Presentar junto a este carnet su documento de identidad", {
        x: 20,
        y: 40,
        size: 10,
        font
    });

    const pdfBytes = await pdfDoc.save();

    // Descargar
    const blob = new Blob([pdfBytes], { type: "application/pdf" });
    const url = URL.createObjectURL(blob);

    const a = document.createElement("a");
    a.href = url;
    a.download = "Carnet.pdf";
    a.click();
    URL.revokeObjectURL(url);
}
</script>

</body>
</html>
